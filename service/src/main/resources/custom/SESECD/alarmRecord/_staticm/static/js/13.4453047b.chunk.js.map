{"version":3,"sources":["pages/view/eventDetails/index.tsx"],"names":["createForm","props","useState","data","setData","sessionData","setSessionData","requestParams","GetRequest","window","location","href","useEffect","eventDetails","JSON","parse","sessionStorage","getItem","initData","id","a","getEventData","mapPoint","coordinates","lon","toFixed","lat","hei","console","log","fillProps","mode","onLeftClick","removeItem","tabIndex","eventEditing","status","changeAlarm","param","alarmId","alarmLevel","changeAlarmState","Toast","info","eventClose","closeEvent","className","accidentName","happenTime","dateFormat","Date","position","wounderPerson","description","receiver","name","hpnCompany","rectime","alarmPerson","alarmPhone","value","hpmDepartment","deathPerson","processState","process","isAlarm","type","style","backgroundColor","width","onClick"],"mappings":"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","file":"static/js/13.4453047b.chunk.js","sourcesContent":["/* eslint-disable @typescript-eslint/indent */\r\n/* eslint-disable */\r\nimport React, { FC, useState, useEffect } from 'react';\r\nimport { AdpOrgRefrence, SupItem, SupLabel, SupNavBar, SupNavBarProps } from '@sup-mobile/ui';\r\nimport { JSBridge } from '@sup-mobile/framework';\r\nimport { Tabs, WhiteSpace, Badge, List, Button, InputItem, Picker, DatePicker, Accordion, Toast, TextareaItem } from 'antd-mobile';\r\nimport './index.less';\r\nimport { dateFormat, GetRequest } from '../../../util/common';\r\nimport { createForm } from 'rc-form';\r\nimport { getEventData, changeAlarmState, closeEvent } from '../../../api/requestConfig';\r\nexport default createForm()((props: any) => {\r\n\r\n  const [data, setData] = useState<any>({});\r\n  const [sessionData, setSessionData] = useState<any>({})\r\n  let requestParams = GetRequest(window.location.href);\r\n\r\n  useEffect(() => {\r\n    const eventDetails = JSON.parse(sessionStorage.getItem('eventDetails') as any)\r\n    setSessionData(eventDetails)\r\n    initData(eventDetails.id)\r\n  }, []);\r\n\r\n  const initData = async(id: string) => {\r\n    let data = await getEventData(id)\r\n    data = {\r\n      ...data,\r\n      mapPoint: data.mapPoint ? `lon:${JSON.parse(data.mapPoint).coordinates[0].lon.toFixed(4)},` + `lat:${JSON.parse(data.mapPoint).coordinates[0].lat.toFixed(4)},` + `hei:${JSON.parse(data.mapPoint).coordinates[0].hei.toFixed(4)}` : ''\r\n    }\r\n    console.log(data.mapPoint);\r\n    \r\n    setData(data);\r\n  }\r\n\r\n  // 刷新\r\n  const fillProps: SupNavBarProps = {\r\n    mode: 'fill',\r\n    onLeftClick: () => {\r\n      sessionStorage.removeItem('eventDetails')\r\n      window.location.href = `#/demo/eventList?tabIndex=${requestParams.tabIndex}`\r\n    },\r\n\r\n  };\r\n\r\n  const eventEditing = (status: string)=> {\r\n    window.location.href = `#/demo/eventEditing?id=${data.id}&index=${requestParams.tabIndex}&status=${status}`\r\n  }\r\n\r\n  const changeAlarm = async() => {\r\n    const param = {\r\n      alarmId: data.id,\r\n      alarmLevel: data?.alarmLevel?.id || 'SESECD_alarmLevel/001'\r\n    }\r\n    const res = await changeAlarmState(param)\r\n    if(res) {\r\n      Toast.info('处警成功', 1, () => { window.location.href = `#/demo/eventList?tabIndex=0` });\r\n    } else {\r\n      Toast.info('处警失败', 1);\r\n    }\r\n  }\r\n\r\n  const eventClose = async() => {\r\n    const res = await closeEvent(data.id)\r\n    if(res) {\r\n      Toast.info('事件结束成功', 1, () => { window.location.href = `#/demo/eventList?tabIndex=1` });\r\n    } else {\r\n      Toast.info('事件结束失败', 1);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"eventDetails-root\">\r\n      <SupNavBar  {...fillProps}>事件详情</SupNavBar>\r\n      <div className='eventDetails-info-root'>\r\n        <div>\r\n          <div>事件名称</div>\r\n          <div>{data?.accidentName}</div>\r\n        </div>\r\n        <div>\r\n          <div>事件时间</div>\r\n          <div>{data?.happenTime ? dateFormat(new Date(data?.happenTime),'YYYY-mm-dd HH:MM:SS') : '-'}</div>\r\n        </div>\r\n        <div>\r\n          <div>事发地点</div>\r\n          <div>{data?.position}</div>\r\n        </div>\r\n        <div>\r\n          <div>受伤人数</div>\r\n          <div>{data?.wounderPerson}</div>\r\n        </div>\r\n        <div>\r\n          <div>事件描述</div>\r\n          <div>{data?.description}</div>\r\n        </div>\r\n        <div>\r\n          <div>接警人</div>\r\n          <div>{data?.receiver?.name}</div>\r\n        </div>\r\n        <div>\r\n          <div>地图坐标</div>\r\n          <div>{data?.mapPoint}</div>\r\n        </div>\r\n        <div>\r\n          <div>事发公司</div>\r\n          <div>{data?.hpnCompany?.name}</div>\r\n        </div>\r\n        <div>\r\n          <div>接警时间</div>\r\n          <div>{data?.rectime ? dateFormat(new Date(data?.rectime),'YYYY-mm-dd HH:MM:SS') : '-'}</div>\r\n        </div>\r\n        <div>\r\n          <div>报警人</div>\r\n          <div>{data?.alarmPerson?.name}</div>\r\n        </div>\r\n        <div>\r\n          <div>报警人电话</div>\r\n          <div>{data?.alarmPhone}</div>\r\n        </div>\r\n        <div>\r\n          <div>事件等级</div>\r\n          <div>{data?.alarmLevel?.value}</div>\r\n        </div>\r\n        <div>\r\n          <div>事发部门</div>\r\n          <div>{data?.hpmDepartment?.name}</div>\r\n        </div>\r\n        <div>\r\n          <div>死亡人数</div>\r\n          <div>{data?.deathPerson}</div>\r\n        </div>\r\n        <div>\r\n          <div>处理状态</div>\r\n          <div>{data?.processState?.value}</div>\r\n        </div>\r\n        <div>\r\n          <div>处理记录</div>\r\n          <div>{data?.process}</div>\r\n        </div>\r\n      </div>\r\n      {sessionData.isAlarm === 'alarm'\r\n        ? <div className='root-footer-main'>\r\n          <Button type=\"primary\" style={{ backgroundColor: '#2972D5', width: '96%' }} onClick={() => changeAlarm()}>处警</Button>\r\n        </div>\r\n        : sessionData.isAlarm === 'event'\r\n          ? <div className='root-footer-main'>\r\n            <Button type=\"primary\" style={{ backgroundColor: '#2972D5', width: '48%' }} onClick={() => eventEditing('open')}>应急处置</Button>\r\n            <Button type=\"primary\" style={{ backgroundColor: '#2972D5', width: '48%' }} onClick={() => eventClose()}>结束事件</Button>\r\n          </div> : <div className='root-footer-main'>\r\n            <Button type=\"primary\" style={{ backgroundColor: '#2972D5', width: '96%' }} onClick={() => eventEditing('close')}>应急处置</Button>\r\n          </div>}\r\n    </div>\r\n\r\n  );\r\n}\r\n)"],"sourceRoot":""}